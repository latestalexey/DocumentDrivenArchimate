<!DOCTYPE html>
<html ng-app="app">
<head>
  <meta charset="utf-8">
  <title>d3js_archimate</title>
  <link rel="stylesheet" href="app.css">


  <script src="angular.min.js"></script>
  <script src="http://localhost/DocumentDrivenArchimate/bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/polymer/polymer.html" />
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-tabs/paper-tabs.html" />
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-dialog/paper-dialog.html" />
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-button/paper-button.html" />
  <!-- icons -->
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/iron-icons/iron-icons.html">
  <!--<link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/iron-icons/maps-icons.html">
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/iron-iconset-svg/iron-iconset-svg.html">-->
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/iron-pages/iron-pages.html" />

  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-toast/paper-toast.html" />

  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/iron-flex-layout/classes/iron-flex-layout.html" />

  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-toolbar/paper-toolbar.html" />
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-menu/paper-menu.html" />
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-icon-button/paper-icon-button.html" />
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-listbox/paper-listbox.html" />
  <link rel="import" href="http://localhost/DocumentDrivenArchimate/bower_components/paper-input/paper-input.html" />

  <link rel="import" href="http://localhost/DocumentDrivenArchimate/customelements.html" />

  <link rel="import" href="http://localhost/DocumentDrivenArchimate/theme/classical/classical.html" />

  <!-- use paper-toast to indicate that saves wont be saved -->

  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="resources/archimate_configuration.js"></script>
  <script src="documentmodengine.js"></script>

  <script>
  //prepare('http://localhost/Archisurance.xml',"de");
  prepare('http://localhost/Reference%20Model.xml','en');

  angular.module('app', [])
  .controller('createTabs', ['$scope', function createTabs($scope) {
    $scope.tabs = [{id:"div0"},{id:"div1"}];
  }])
  .controller('createPages', ['$scope', function createPages($scope) {
    $scope.pages = [];
  }]);

  function updateMenu(){
    if(window.done){

      for(var i=0;i < window.viewsdata.children().size();i++){
        var tab = {};
        tab.tabtext = $(window.viewsdata.children().eq(i)).children('label[xml\\:lang="'+functions.usersettings.lang+'"]').text();
        tab.divid = "div"+i;
        tab.content = window.viewvisualisations[i]
        //t.stuff.push(tab);
        if(!menu.stuff){
          menu.stuff = [];
        }
        menu.stuff = menu.stuff.concat(tab);
      }

    }else{
      setTimeout(updateMenu,100);
    }
  }

  </script>


</head>

<body ng-model="selected" onload="updateMenu()">
<paper-toast text="Warning! You have not checked out the Model. Changes won't be saved." opened></paper-toast>
<script>
function addmodelreference(){

  window.links[mr.label].push({
    label: document.querySelector("#linkname").value,
    link: document.querySelector("#linkactual").value,
    disabled: false
  })
  var event = new Event('LinkAdded');
  document.dispatchEvent(event);
}
</script>
<paper-dialog id="linkdialog" style="width:50%" >
 <h2>Add Link</h2>
  <paper-dialog-scrollable>
    <paper-input id="linkname" label="Link name" style="padding:20px" value="{{value}}"></paper-input>
    <paper-input id="linkactual" label="Link" style="padding:20px" value="{{value}}"></paper-input>
  </paper-dialog-scrollable>
  <div class="buttons">
    <paper-button dialog-dismiss >Cancel</paper-button>
    <paper-button dialog-confirm onclick="addmodelreference()">Accept</paper-button>
  </div>
</paper-dialog>

<model-menu id="menu"></model-menu>
<model-zoom></model-zoom>

<model-references id="mr">

</model-references>

</body>


</html>
